<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generador: P√°gina de M√∫sica</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background:#faf5ff; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto;}
    textarea, input { outline: none; }
  </style>
</head>
<body class="p-8">

  <h1 class="text-3xl font-bold text-pink-600 mb-4">üéµ Generador de p√°gina musical</h1>

  <!-- Artist + Song -->
  <div class="grid grid-cols-2 gap-4 mb-4">
    <div>
      <label class="block font-medium mb-1">Artista</label>
      <input id="artist" class="w-full border rounded px-3 py-2" placeholder="Karol G" />
    </div>
    <div>
      <label class="block font-medium mb-1">Canci√≥n</label>
      <input id="song" class="w-full border rounded px-3 py-2" placeholder="Contigo" />
    </div>
  </div>

  <!-- Theme -->
  <div class="mb-4">
    <label class="block font-medium mb-1">Tema</label>
    <select id="theme" class="w-full border rounded px-3 py-2">
      <option>Rom√°ntico</option>
      <option>Energ√©tico</option>
      <option>Nost√°lgico</option>
      <option>Urbano</option>
      <option>Solemne</option>
      <option selected>Gen√©rico</option>
      <option>Reggaet√≥n</option>
      <option>Flamenco</option>
      <option>Bachata</option>
      <option>Dembow</option>
    </select>
  </div>

  <!-- Image -->
  <div class="mb-4">
    <label class="block font-medium mb-1">Imagen (URL de GitHub)</label>
    <input id="imageURL" class="w-full border rounded px-3 py-2" placeholder="https://raw.githubusercontent.com/...jpg" />
    <input id="caption" class="w-full border rounded px-3 py-2 mt-1" placeholder="Subt√≠tulo opcional" />
  </div>

  <!-- Spotify + YouTube -->
  <div class="grid grid-cols-2 gap-4 mb-4">
    <div>
      <label class="block font-medium mb-1">Enlace Spotify (embed)</label>
      <input id="spotify" class="w-full border rounded px-3 py-2" placeholder="https://open.spotify.com/embed/track/..." />
    </div>
    <div>
      <label class="block font-medium mb-1">Enlace YouTube (embed o ID)</label>
      <input id="youtube" class="w-full border rounded px-3 py-2" placeholder="https://www.youtube.com/embed/ID o ID" />
    </div>
  </div>

  <!-- Cloze -->
  <div class="mb-4">
    <label class="block font-medium mb-1">Letra con espacios en blanco</label>
    <textarea id="cloze" rows="6" class="w-full border rounded px-3 py-2" placeholder="De mi parte
1)_Sigo recordando cuando tomaba tu 2)_mano
La vida se me est√° yendo 3)_pensando ..."></textarea>
    <p class="text-sm text-gray-500 mt-1">Enter = revisar, Tab = siguiente campo.</p>
  </div>

  <button id="generate" class="bg-gradient-to-r from-fuchsia-500 to-pink-500 text-white font-semibold rounded px-6 py-3 hover:opacity-90">Generar p√°gina completa</button>
  <button id="copy" class="ml-3 bg-gray-800 text-white rounded px-4 py-2">Copiar</button>

  <!-- Output -->
  <div class="mt-6">
    <textarea id="output" rows="22" class="w-full border rounded p-4 font-mono text-sm"></textarea>
  </div>

  <script>
    const T = {
      "Rom√°ntico": {accent:"text-pink-600",  border:"border-pink-400",  hdr:"from-pink-500 via-fuchsia-500 to-purple-600"},
      "Energ√©tico":{accent:"text-amber-600", border:"border-amber-400", hdr:"from-orange-400 via-amber-400 to-red-500"},
      "Nost√°lgico":{accent:"text-sky-600",   border:"border-sky-400",   hdr:"from-sky-400 via-indigo-400 to-purple-500"},
      "Urbano":    {accent:"text-violet-600",border:"border-violet-400",hdr:"from-violet-700 via-slate-700 to-gray-800"},
      "Solemne":   {accent:"text-slate-600", border:"border-slate-400", hdr:"from-gray-500 via-slate-500 to-gray-700"},
      "Gen√©rico":  {accent:"text-indigo-600",border:"border-indigo-400",hdr:"from-blue-400 via-indigo-400 to-sky-500"},
      "Reggaet√≥n": {accent:"text-orange-600",border:"border-orange-400",hdr:"from-yellow-400 via-orange-500 to-pink-600"},
      "Flamenco":  {accent:"text-red-600",   border:"border-red-400",   hdr:"from-red-600 via-amber-500 to-yellow-500"},
      "Bachata":   {accent:"text-rose-600",  border:"border-rose-400",  hdr:"from-rose-400 via-amber-300 to-pink-500"},
      "Dembow":    {accent:"text-lime-600",  border:"border-lime-400",  hdr:"from-lime-400 via-cyan-400 to-teal-500"}
    };

    const $ = id => document.getElementById(id);

    const artistEl = $('artist');
    const songEl   = $('song');
    const themeEl  = $('theme');
    const imageURL = $('imageURL');
    const caption  = $('caption');
    const spotify  = $('spotify');
    const youtube  = $('youtube');
    const cloze    = $('cloze');
    const output   = $('output');

    function ytId(val){
      if(!val) return "";
      try{
        const u = new URL(val);
        if(u.hostname.includes("youtu.be")) return u.pathname.slice(1);
        if(u.hostname.includes("youtube.com")) return u.searchParams.get("v") || u.pathname.split("/embed/")[1] || "";
      } catch { return val; }
      return val;
    }

    function headerHTML({artist, song, theme}) {
      const {hdr} = T[theme];
      return `
<header class="shadow-2xl rounded-2xl overflow-hidden mb-6">
  <div class="bg-gradient-to-r ${hdr} text-white text-center py-10 px-6">
    <h1 class="text-5xl font-extrabold tracking-wide drop-shadow-lg">${artist || "Artista"}</h1>
    <p class="text-2xl italic text-white/90 mt-2 drop-shadow">‚Äú${song || "T√≠tulo"}‚Äù</p>
  </div>
</header>`;
    }

    function imageHTML(url, caption, artist, theme) {
      if(!url.trim()) return "";
      const {accent, border} = T[theme];
      return `
<section class="bg-white rounded-xl shadow p-6 border ${border} mb-4">
  <h3 class="text-lg font-semibold mb-3 ${accent}">${artist || "Artista"}</h3>
  <figure class="p-2">
    <img src="${url}" alt="imagen" class="rounded-xl shadow w-1/3 mx-auto" />
    ${caption ? `<figcaption class="text-center text-xs text-gray-500 mt-2">${caption}</figcaption>` : ""}
  </figure>
</section>`;
    }

    function clozeHTML(text, theme){
      if(!text.trim()) return "";
      const {accent, border} = T[theme];
      const withInputs = text
        .replace(/\r\n/g,"\n").replace(/\n/g,"<br>")
        .replace(/(\d+)\)_([^\s<]+)/g, (m,n,word)=> `<span class="font-semibold">${n})</span>_<input type="text" class="cloze-inp border rounded px-2 py-0.5 mx-1 w-28 align-baseline" data-answer="${word}" aria-label="Hueco ${n}">`);
      return `
<section class="bg-white rounded-xl shadow p-6 border-l-4 ${border} mb-4">
  <h2 class="font-semibold text-lg mb-3 ${accent}">üìù Completa la letra</h2>
  <div class="leading-relaxed text-gray-800">${withInputs}</div>
  <div class="mt-4 flex gap-3">
    <button type="button" class="cloze-check bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg px-3 py-1.5 text-sm">Revisar</button>
    <button type="button" class="cloze-reset bg-gray-600 hover:bg-gray-700 text-white rounded-lg px-3 py-1.5 text-sm">Reiniciar</button>
  </div>
</section>`;
    }

    function spotifyHTML(url, theme){
      if(!url.trim()) return "";
      const {accent, border} = T[theme];
      return `
<section class="bg-white rounded-xl shadow p-6 border-l-4 ${border} mb-4">
  <h2 class="font-semibold text-lg mb-2 ${accent}">üéß Escucha en Spotify</h2>
  <iframe style="border-radius:12px" src="${url}" width="100%" height="152" frameborder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>
</section>`;
    }

    function youtubeHTML(val, theme){
      const id = ytId(val);
      if(!id) return "";
      const {accent, border} = T[theme];
      return `
<section class="bg-white rounded-xl shadow p-6 border-l-4 ${border} mb-4">
  <h2 class="font-semibold text-lg mb-2 ${accent}">üé¨ Video</h2>
  <div class="aspect-video">
    <iframe class="w-full h-full rounded-md" src="https://www.youtube.com/embed/${id}" frameborder="0" allowfullscreen></iframe>
  </div>
</section>`;
    }

    $('generate').addEventListener('click', ()=>{
      const artist = artistEl.value.trim();
      const song   = songEl.value.trim();
      const theme  = themeEl.value;
      const image  = imageURL.value.trim();

      const meta = `<!-- music-meta {
  "artist": "${artist}",
  "song": "${song}",
  "theme": "${theme}",
  "image": "${image}"
} -->`;

      let html = "";
      html += "<!DOCTYPE html><html lang='es'><head><meta charset='UTF-8'><meta name='viewport' content='width=device-width,initial-scale=1.0'><title>"+(artist||"Artista")+" ‚Äì ‚Äú"+(song||"T√≠tulo")+"‚Äù</title><script src='https://cdn.tailwindcss.com'><\/script></head>";
      html += "<body class='font-sans bg-gray-100 min-h-screen p-6'><div class='max-w-5xl mx-auto space-y-6'>";
      html += meta;
      html += headerHTML({artist, song, theme});
      html += imageHTML(image, caption.value, artist, theme);
      html += clozeHTML(cloze.value, theme);
      html += spotifyHTML(spotify.value, theme);
      html += youtubeHTML(youtube.value, theme);
      html += "<footer class='text-center text-xs text-gray-500 pt-6'>Creado para clase ¬∑ "+(artist||"Artista")+" ‚Äì ‚Äú"+(song||"T√≠tulo")+"‚Äù</footer>";
      html += "</div></body></html>";

      output.value = html;
    });

    $('copy').addEventListener('click', ()=>{
      output.select();
      document.execCommand('copy');
      alert('¬°C√≥digo copiado!');
    });

    // defaults
    artistEl.value = 'Karol G';
    songEl.value   = 'Contigo';
  </script>
</body>
</html>
