<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lectura Dual Generator (JSON + HTML)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: ui-sans-serif, system-ui, -apple-system, sans-serif; }
    textarea { font-family: ui-monospace, monospace; font-size: 0.85rem; }
    .mono { font-family: ui-monospace, monospace; }
  </style>
</head>
<body class="bg-slate-100 text-slate-900">
  <div class="max-w-6xl mx-auto p-6 space-y-6">
    
    <header class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200">
      <h1 class="text-3xl font-black tracking-tight text-orange-600">Lectura Dual Generator</h1>
      <p class="text-slate-600 mt-2">Generate both the <b>Data (JSON)</b> and the <b>Layout (HTML)</b> for Lectora.</p>
    </header>

    <section class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200 space-y-4">
      <h2 class="text-xl font-black">1) Metadata & Content</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <input id="titulo" class="w-full border rounded-lg p-2" placeholder="TÃ­tulo (e.g. RosalÃ­a)" />
        <input id="subtitulo" class="w-full border rounded-lg p-2" placeholder="SubtÃ­tulo" value="Lectura ðŸ“•" />
        <input id="imgMain" class="w-full border rounded-lg p-2" placeholder="URL de Imagen Principal" />
        <input id="tag" class="w-full border rounded-lg p-2" placeholder="Tag (e.g. EspaÃ±a)" />
      </div>
      <textarea id="textoRaw" rows="8" class="w-full border rounded-xl p-3" placeholder="Pega el texto aquÃ­..."></textarea>
    </section>

    <section class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-black">2) Questions</h2>
            <button onclick="addShortQuestion()" class="bg-blue-600 text-white px-4 py-1 rounded-lg text-sm font-bold">+ Add Question</button>
        </div>
        <div id="questionList" class="space-y-4"></div>
    </section>

    <section class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200 space-y-4">
        <h2 class="text-lg font-black flex justify-between">
            JSON Data 
            <button onclick="copyToClipboard('jsonOutput')" class="text-xs bg-slate-200 px-2 py-1 rounded">Copy</button>
        </h2>
        <textarea id="jsonOutput" rows="15" class="w-full border rounded-xl p-3 bg-slate-50 text-blue-800" readonly></textarea>
      </div>

      <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200 space-y-4">
        <h2 class="text-lg font-black flex justify-between">
            Static HTML (for Lectora)
            <button onclick="copyToClipboard('htmlOutput')" class="text-xs bg-slate-200 px-2 py-1 rounded">Copy</button>
        </h2>
        <textarea id="htmlOutput" rows="15" class="w-full border rounded-xl p-3 bg-slate-50 text-emerald-800" readonly></textarea>
      </div>
    </section>

    <div class="text-center">
        <button onclick="generateBoth()" class="bg-orange-600 text-white px-10 py-4 rounded-full font-black text-xl hover:scale-105 transition-transform shadow-lg">
            GENERATE OUTPUTS
        </button>
    </div>
  </div>

<script>
  // Simplified Question Logic for demonstration
  function addShortQuestion() {
      const div = document.createElement('div');
      div.className = "p-3 border rounded-lg bg-slate-50 flex gap-2";
      div.innerHTML = `
        <input class="qPrompt flex-1 border p-1 rounded" placeholder="Pregunta">
        <input class="qAnswer flex-1 border p-1 rounded" placeholder="Respuesta">
      `;
      document.getElementById('questionList').appendChild(div);
  }

  function generateBoth() {
      const titulo = document.getElementById('titulo').value;
      const subtitulo = document.getElementById('subtitulo').value;
      const textoRaw = document.getElementById('textoRaw').value;
      const imagen = document.getElementById('imgMain').value;
      
      const paragraphs = textoRaw.split(/\n\s*\n/).filter(Boolean);
      
      const questions = [];
      document.querySelectorAll('#questionList div').forEach(qDiv => {
          questions.push({
              tipo: "short",
              pregunta: qDiv.querySelector('.qPrompt').value,
              respuesta: qDiv.querySelector('.qAnswer').value
          });
      });

      // 1. GENERATE JSON
      const jsonData = {
          titulo,
          subtitulo,
          imagen,
          contenido: { texto: paragraphs, preguntas: questions }
      };
      document.getElementById('jsonOutput').value = JSON.stringify(jsonData, null, 2);

      // 2. GENERATE STATIC HTML
      // This builds the exact HTML structure your "lectura.html" renderer expects
      let textHtml = paragraphs.map(p => `<p class="mb-4">${p}</p>`).join('');
      
      let qaHtml = questions.map((q, i) => `
        <div class="rounded-xl border border-slate-200 overflow-hidden mb-4">
          <div class="p-4 bg-slate-50 border-b border-slate-200">
            <div class="text-[11px] font-black uppercase tracking-widest text-slate-400">Pregunta ${i+1}</div>
            <div class="text-slate-900 font-bold mt-1">${q.pregunta}</div>
          </div>
          <div class="p-4">
            <div class="text-[11px] font-black uppercase tracking-widest text-slate-400 mb-2">Respuesta</div>
            <div class="p-3 rounded-lg border border-slate-200 bg-white text-slate-800">
              ${q.respuesta}
            </div>
          </div>
        </div>`).join('');

      const fullHtml = `
<div class="max-w-4xl mx-auto p-4 space-y-6">
  <header class="bg-orange-500 rounded-xl p-6 text-white shadow-md">
    <h1 class="text-3xl font-extrabold">${titulo}</h1>
    <p class="italic">${subtitulo}</p>
  </header>
  ${imagen ? `<img src="${imagen}" class="w-full h-64 object-cover rounded-xl shadow-md">` : ''}
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <article class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
      <h2 class="font-black mb-4">ðŸ“– Texto</h2>
      <div class="text-slate-800 leading-relaxed">${textHtml}</div>
    </article>
    <article class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
      <h2 class="font-black mb-4">âœ… Preguntas</h2>
      <div>${qaHtml}</div>
    </article>
  </div>
</div>`;

      document.getElementById('htmlOutput').value = fullHtml.trim();
  }

  function copyToClipboard(id) {
      const copyText = document.getElementById(id);
      copyText.select();
      document.execCommand("copy");
      alert("Copied to clipboard!");
  }
</script>
</body>
</html>
