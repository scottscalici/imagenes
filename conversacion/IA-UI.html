<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Sr. Scalici - Generador de Oral Individual</title>
    <style>
        :root { --primary: #2c3e50; --accent: #3498db; --success: #27ae60; --warning: #f1c40f; --danger: #e74c3c; --light: #ecf0f1; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--light); padding: 20px; }
        .setup-panel { background: #fff; padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 2px solid var(--accent); }
        .hidden { display: none !important; }
        .main-container { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
        .stimulus-box img { width: 100%; border-radius: 8px; border: 1px solid #ddd; }
        .timer { font-size: 3.5rem; font-weight: bold; text-align: center; color: var(--primary); }
        .notes-area { border: 1px solid #ddd; padding: 15px; border-radius: 8px; height: 400px; overflow-y: auto; }
        .btn { cursor: pointer; border: none; padding: 12px; border-radius: 6px; font-weight: bold; color: white; transition: 0.2s; }
        .btn-launch { background: var(--accent); width: 100%; font-size: 1.2rem; }
        .btn-lvl1 { background: var(--success); } .btn-lvl2 { background: var(--warning); color: #333; } .btn-lvl3 { background: var(--danger); }
        .bullet-line { display: flex; align-items: center; margin-bottom: 8px; }
        .question-box { background: #fffceb; border: 2px solid #f1c40f; padding: 15px; margin-top: 10px; border-radius: 8px; }
    </style>
</head>
<body>

<div id="setupPanel" class="setup-panel">
    <h2>âš™ï¸ ConfiguraciÃ³n del Profesor</h2>
    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
        <div>
            <label>URL de la Imagen:</label>
            <input type="text" id="imgUrlInput" placeholder="Pega el link de la imagen aquÃ­...">
        </div>
        <div>
            <label>Tema IB:</label>
            <select id="themeSelect">
                <option value="sharing">Compartimos el planeta</option>
                <option value="identities">Identidades</option>
                <option value="experiences">Experiencias</option>
                <option value="ingenuity">Ingenio humano</option>
                <option value="organization">OrganizaciÃ³n social</option>
            </select>
        </div>
        <div>
            <label>Tier (Nivel):</label>
            <select id="tierSelect" onchange="updateTierUI()">
                <option value="1">Tier 1 (Script)</option>
                <option value="5">Tier 5 (10 Bullets)</option>
                <option value="7">Tier 7 (No Bullets + Question)</option>
                <option value="10">Tier 10 (Mastery)</option>
            </select>
        </div>
    </div>
    <button class="btn btn-launch" style="margin-top:20px" onclick="launchSession()">ğŸš€ Lanzar PrÃ¡ctica</button>
</div>

<div id="studentView" class="main-container hidden">
    <div id="missionText" style="font-weight:bold; color:var(--accent); margin-bottom:10px;"></div>
    
    <div class="grid">
        <div>
            <div id="imageContainer" class="stimulus-box"></div>
            <div class="timer" id="timerDisplay">00:00</div>
            <button id="mainActionBtn" class="btn btn-launch" onclick="handleTimer()">Empezar PreparaciÃ³n</button>
        </div>
        
        <div>
            <div class="notes-area" id="notesContainer"></div>
            <div id="studentQuestionArea" class="hidden">
                <p><strong>Escribe tu pregunta para tu compaÃ±ero:</strong></p>
                <textarea id="customQuestion" style="width:95%; height:60px;"></textarea>
            </div>
            <div style="margin-top:10px; text-align:center;">
                <a href="https://sites.google.com/view/srscalici/vocabulario/modismos" target="_blank">Modismos</a> | 
                <a href="https://sites.google.com/view/srscalici/ib-espa%C3%B1ol-ii/ib/conexiones-culturales" target="_blank">Conexiones Culturales</a>
            </div>
        </div>
    </div>

    <div id="interactionZone" class="hidden" style="margin-top:30px; border-top:2px solid #eee; padding-top:20px;">
        <div id="displayQuestion" style="font-size:1.3rem; text-align:center; margin-bottom:20px; font-weight:bold;"></div>
        <div style="display:flex; gap:10px; justify-content:center;">
            <button class="btn btn-lvl1" onclick="ask(1)">Nivel 1</button>
            <button class="btn btn-lvl2" onclick="ask(2)">Nivel 2</button>
            <button class="btn btn-lvl3" onclick="ask(3)">Nivel 3</button>
            <button class="btn" style="background:#2c3e50" onclick="ask('extra')">Â¡Explica mÃ¡s!</button>
        </div>
    </div>
</div>

<script>
const themeQuestions = {
    sharing: {
        1: ["Â¿QuÃ© es lo mÃ¡s importante que ves en la foto?", "Â¿QuÃ© tiempo hace en la imagen?"],
        2: ["Â¿Haces algo similar en tu casa para ayudar al planeta?", "Â¿Es este un problema comÃºn en tu comunidad?"],
        3: ["Â¿CÃ³mo cambiarÃ­a la situaciÃ³n si el gobierno no interviniera?", "Â¿CuÃ¡l es el desafÃ­o mÃ¡s grande del mundo hispano aquÃ­?"]
    },
    identities: {
        1: ["Â¿CÃ³mo estÃ¡n vestidas las personas?", "Â¿QuÃ© emociones expresan?"],
        2: ["Â¿CÃ³mo influye la ropa en la identidad de estos jÃ³venes?", "Â¿En quÃ© se parece tu estilo de vida a esto?"],
        3: ["Â¿Hasta quÃ© punto la lengua define quiÃ©nes somos?", "Â¿CÃ³mo afecta la globalizaciÃ³n a las identidades locales?"]
    },
    extra: ["Â¿Puedes darme un ejemplo especÃ­fico?", "Â¿QuÃ© dirÃ­a alguien que no estÃ¡ de acuerdo?", "Â¿CÃ³mo afectarÃ¡ esto al futuro?"]
};

let currentState = 'config';
let seconds = 0;
let timerLoop;

function launchSession() {
    document.getElementById('setupPanel').classList.add('hidden');
    document.getElementById('studentView').classList.remove('hidden');
    document.getElementById('imageContainer').innerHTML = `<img src="${document.getElementById('imgUrlInput').value}">`;
    updateTierUI();
}

function updateTierUI() {
    const tier = document.getElementById('tierSelect').value;
    const notes = document.getElementById('notesContainer');
    const qArea = document.getElementById('studentQuestionArea');
    
    notes.innerHTML = "";
    qArea.classList.add('hidden');

    if(tier == "7") {
        notes.innerHTML = "<em>No se permiten balas en este nivel. PrepÃ¡rate mentalmente.</em>";
        qArea.classList.remove('hidden');
    } else {
        let count = tier >= 5 ? 10 : 20;
        for(let i=1; i<=count; i++) {
            notes.innerHTML += `<div class="bullet-line"><span>${i}.</span><input type="text" style="width:90%"></div>`;
        }
    }
}

function handleTimer() {
    const btn = document.getElementById('mainActionBtn');
    if(btn.innerText === "Empezar PreparaciÃ³n") {
        seconds = 15 * 60; // Standard 15m, can be adjusted
        startTimer(true);
        btn.innerText = "Â¡Listo para Hablar!";
    } else {
        clearInterval(timerLoop);
        seconds = 0;
        startTimer(false); // Count up practice
        btn.innerText = "Terminar y Ver Preguntas";
        btn.onclick = showQuestions;
    }
}

function startTimer(countDown) {
    timerLoop = setInterval(() => {
        countDown ? seconds-- : seconds++;
        let m = Math.floor(Math.abs(seconds)/60);
        let s = Math.abs(seconds)%60;
        document.getElementById('timerDisplay').innerText = `${m}:${s<10?'0':''}${s}`;
    }, 1000);
}

function showQuestions() {
    clearInterval(timerLoop);
    document.getElementById('interactionZone').classList.remove('hidden');
}

function ask(lvl) {
    const theme = document.getElementById('themeSelect').value;
    const bank = lvl === 'extra' ? themeQuestions.extra : themeQuestions[theme][lvl];
    document.getElementById('displayQuestion').innerText = bank[Math.floor(Math.random()*bank.length)];
}
</script>
</body>
</html>
